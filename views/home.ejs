<% include layout/header %>
   <h1 class="text-center">
      Garbage Bins
   </h1>
   <% if(Object.keys(current.admin).length){ %>
      <div class="row">
         <div class="col-md-9"></div>
         <div class="col-md-3">
            <a class="btn btn-lg btn-success" href="/add">Add Bins</a>
         </div>
      </div>
   <% } %>
   <div class="container d-flex flex-wrap">
      <% products.forEach( (product, i) => {%>
         <div class="card bg-dark text-white m-4" style="width: 18rem;">
            <div class="card-body">
               <h5 class="card-title">
                  <div class="row">
                     <div class="col-md-10">
                        <%= product.pName %>
                     </div>
                     <% if(Object.keys(current.admin).length){ %>
                        <div class="col-md-2">
                           <form action="/delete" method="post">
                              <select name="pid" class="d-none">
                                 <option><%= product._id %></option>
                              </select>
                              <button class="btn btn-sm btn-danger">X</button>
                           </form>
                        </div>
                     <% } %>
                  </div>
               </h5>
               <ul class="list-group">
                  <li class="list-group-item list-group-item-dark"><b>Supervisor:</b> <%= admins[i] %></li>
                  <li class="list-group-item list-group-item-dark"><b>Added Date:</b> <%= `${product.expDate.getDate()}/${product.expDate.getMonth()}/${product.expDate.getFullYear()}` %></li>
                  <li class="list-group-item list-group-item-dark"><b>Locality:</b> <%= product.warehouse %></li>
                  <% if(product.machines.length > 0){ %>
                     <li class="list-group-item list-group-item-dark">
                        <b>Vehicles:</b>
                        <ul class="list-group mt-2">
                           <% product.machines.forEach( machine => { %>
                              <li class="list-group-item list-group-item-dark"><%= machine %></li>
                           <% }) %>   
                        </ul>
                     </li>
                  <% } %>
                  <li class="list-group-item list-group-item-dark">
                     <b>Bin Level:</b>
                     <% if(i==0){%>
                        <div class="progress ml-2 mr-2 mt-2">
                           <div class="progress-bar progress-bar-striped bg-success" role="progressbar" style="width: 25%"></div>
                        </div>
                     <% } %>
                     <% if(i==1){%>
                        <div class="progress ml-2 mr-2 mt-2">
                           <div class="progress-bar progress-bar-striped bg-danger" role="progressbar" style="width: 100%"></div>
                        </div>
                        <div class="alert alert-danger p-1 m-2 text-center">
                           Bin OVERFLOW!!!
                        </div>
                     <% } %>
                  </li>
               </ul>
            </div>
         </div>
      <% }) %>
   </div>
<% include layout/footer %>